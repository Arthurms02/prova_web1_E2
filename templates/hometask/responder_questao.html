{% extends "base.html" %}

{% block content %}
<main class="col-lg-10 col-12 overflow-auto">
    <!-- Cabeçalho Principal -->
    {% include "partials/_header.html" %}
    <!-- Seção da Questão -->
    <section class="p-4 p-md-5">
        <div class="question-card p-4 p-md-5">
            {% if questao.autor == request.user.perfil %}
            <div class="d-flex flex-direction-row justify-content-between mb-3">
                <a class="btn btn-outline-primary" href="{% url 'hometask:editar_questao' materia_slug=questao.materia.slug pk=questao.pk %}">Editar</a>
                <form action="{% url 'hometask:excluir_questao' materia_slug=questao.materia.slug pk=questao.pk %}" method="POST">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-outline-danger">Excluir</button>
                </form>
            </div>
            {% endif %}
            <!-- Enunciado -->
            <div class="enunciado mb-4">
                {{ questao.enunciado }}

                <!-- IMAGEM DA TABELA -->
                <div class="text-center my-4">
                    {% if questao.complemento %}
                        <img src="{{ questao.complemento.url }}" alt="Imagem da Questão"
                            class="img-fluid rounded shadow-sm enunciado-image">
                    {% endif %}
                </div>
            </div>

            <!-- Formulário de Resposta -->
            <form method="POST" action="{% url 'hometask:detalhe_questao' materia_slug=questao.materia.slug pk=questao.pk %}"
                novalidate>
                {% csrf_token %}
                <div class="alternatives-list">
            
                    {% for radio in form.resposta %}
                    <div class="form-check p-0 mb-2">
            
                        <input type="radio" class="btn-check" name="resposta" id="{{ radio.id_for_label }}"
                            value="{{ radio.data.value }}" autocomplete="off">
            
                        <label class="btn alternative-label w-100 rounded-pill" for="{{ radio.id_for_label }}">
                            <span class="fw-bold me-2">{{ radio.data.value }})</span> {{ radio.choice_label }}
                        </label>
                    </div>
                    {% endfor %}
            
                </div>
            
                <div class="text-center mt-4">
                    <button type="submit" class="btn btn-answer rounded-pill">Responder</button>
                </div>
            </form>
        

        <!-- INÍCIO DA PAGINAÇÃO (Voltar/Avançar) -->
       {% if materia %}
            <div class="d-flex justify-content-between align-items-center mb-4">
                <!-- Questão anterior -->
                {% if anterior_questao %}
                    <a href="{% url 'hometask:detalhe_questao' materia_slug=materia.slug pk=anterior_questao.pk %}" 
                       class="btn btn-outline-primary">
                        <i class="bi bi-chevron-left me-1"></i>
                        Anterior
                    </a>
                {% else %}
                    <span class="btn btn-outline-secondary disabled">
                        <i class="bi bi-chevron-left me-1"></i>
                        Anterior
                    </span>
                {% endif %}

                <!-- Próxima questão -->
                {% if proxima_questao %}
                    <a href="{% url 'hometask:detalhe_questao' materia_slug=materia.slug pk=proxima_questao.pk %}" 
                       class="btn btn-outline-primary">
                        Próximo
                        <i class="bi bi-chevron-right ms-1"></i>
                    </a>
                {% else %}
                    <span class="btn btn-outline-secondary disabled">
                        Próximo
                        <i class="bi bi-chevron-right ms-1"></i>
                    </span>
                {% endif %}
            </div>
        {% endif %}
        <!-- FIM DA PAGINAÇÃO -->
        </div>
    </section>
</main>
{% endblock %}